<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTF Answer Hash Generator</title>
    <style>
        body { font-family: system-ui; max-width: 600px; margin: 40px auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 10px 15px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .output { margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 4px; border-left: 4px solid #007bff; }
        .hash { font-family: monospace; word-break: break-all; background: #e9ecef; padding: 8px; border-radius: 3px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>CTF Answer Hash Generator</h1>
    <p>Use this tool to generate <strong>salted SHA-256 hashes</strong> for your CTF answers. Even if someone sees the hash in your code, they cannot reverse it to find the answer due to the unique salt.</p>
    
    <div class="form-group">
        <label for="answer">Answer (will be normalized: trimmed and lowercased):</label>
        <input type="text" id="answer" placeholder="e.g., CPxCEDT{ENG04}">
    </div>
    
    <div class="form-group">
        <label for="salt">Salt (unique string for this problem):</label>
        <input type="text" id="salt" placeholder="e.g., my_ctf_problem_unique_salt_001">
    </div>
    
    <button onclick="generateHash()">Generate Salted Hash</button>
    
    <div id="output" class="output" style="display: none;">
        <h3>Generated Hash:</h3>
        <div>Normalized answer: <strong id="normalized"></strong></div>
        <div class="hash" id="hash"></div>
        <p><em>Copy this hash and add it as the <code>answerHash</code> property in your problem data. Make sure to also include the <code>salt</code> property.</em></p>
    </div>

    <script>
        function normalize(str) {
            return (str || '').trim().toLowerCase();
        }

        async function saltedSha256(text, salt) {
            const encoder = new TextEncoder();
            const saltedText = salt + text + salt; // Same as problem.js
            const data = encoder.encode(saltedText);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function generateHash() {
            const answer = document.getElementById('answer').value;
            const salt = document.getElementById('salt').value;
            
            if (!answer) {
                alert('Please enter an answer');
                return;
            }
            
            if (!salt) {
                alert('Please enter a salt (unique string for this problem)');
                return;
            }

            const normalized = normalize(answer);
            const hash = await saltedSha256(normalized, salt);
            
            document.getElementById('normalized').textContent = normalized;
            document.getElementById('hash').textContent = hash;
            document.getElementById('output').style.display = 'block';
        }

        // Allow Enter key to generate hash
        document.getElementById('answer').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateHash();
            }
        });
    </script>
</body>
</html>
